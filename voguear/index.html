<!DOCTYPE html>
<html lang="en">
  <head>
    <title>WebAR-t3st</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="demo-styles.css">
    
    <!-- The following libraries and polyfills are recommended to maximize browser support -->
    <!-- NOTE: you must adjust the paths as appropriate for your project -->
    
    <!-- 游뚿 REQUIRED: Web Components polyfill to support Edge and Firefox < 63 -->
    <script src="https://unpkg.com/@webcomponents/webcomponentsjs@2.1.3/webcomponents-loader.js"></script>

    <!-- 游누 OPTIONAL: Intersection Observer polyfill for better performance in Safari and IE11 -->
    <script src="https://unpkg.com/intersection-observer@0.5.1/intersection-observer.js"></script>

    <!-- 游누 OPTIONAL: Resize Observer polyfill improves resize behavior in non-Chrome browsers -->
    <script src="https://unpkg.com/resize-observer-polyfill@1.5.0/dist/ResizeObserver.js"></script>

    <!-- 游누 OPTIONAL: Fullscreen polyfill is required for experimental AR features in Canary -->
    <!--<script src="https://unpkg.com/fullscreen-polyfill@1.0.2/dist/fullscreen.polyfill.js"></script>-->

    <!-- 游누 OPTIONAL: Include prismatic.js for Magic Leap support -->
    <!--<script src="https://unpkg.com/@magicleap/prismatic@0.18.2/prismatic.min.js"></script>-->
    
  </head> 
<body>
	<div align="center" id="top">
    <img src="images/ARtop.gif" width="100%" alt=""/>
	</div>

<div id="card">
  <!-- All you need to put beautiful, interactive 3D content on your site: -->
	<model-viewer id="model-viewer" src="dio.glb" ar ar-modes="webxr quick-look" ar-scale="auto" environment-image="peppermint.hdr" skybox-image="peppermint.hdr" autoplay camera-controls ios-src="dio.usdz">
	 <!--<button onclick="playAnimation('Move','loop')" style="display: block;" class="hotspot-button hotspot-0 annotations_show" slot="hotspot-311020102033" data-position="-0.06583233873289211 1.675235680658444 0.5312583410454528" data-normal="-3.0534946175728854e-14 0.06185443159550054 0.9980851813808266"> 
				            	<div id="annotation"><p>loop</p></div>
				          	</button>
<button onclick="playAnimation('Spin','once')" style="display: block;" class="hotspot-button hotspot-0 annotations_show" slot="hotspot-311020102051" data-position="-0.8681001349615207 1.817890212010441 0.15671418199968132" data-normal="0.5529827444094486 0.4298258515866452 0.7137645421938595"> 
				            	<div id="annotation"><p>once</p></div>
				          	</button>-->
	</model-viewer>
	
<script type="text/javascript">
function playAnimation(animation_name,animation_type) {
  const modelViewer = document.querySelector("model-viewer");   
  if (animation_type == 'once') {
    modelViewer.animationName = animation_name; 
    modelViewer.currentTime = 0;
    modelViewer.play(); 
    var extremelySmallIntervalTime = 0.05;
    var j=0;
    const interval = setInterval(function(){ 
      //console.log(modelViewer.currentTime);
      if(modelViewer.currentTime > 0 && modelViewer.currentTime < (extremelySmallIntervalTime - 0.01))
      { ++j;
        //console.log(j);      
        if ( j > 0 ){
         modelViewer.pause();
         //modelViewer.currentTime = 0;
         j = 0;
         clearInterval(interval);
        }
        
      }else if(modelViewer.currentTime == 0)
      {
        modelViewer.play(); 
      }
    }, extremelySmallIntervalTime*1000);
  }else if(animation_type == 'loop'){
    if (animation_name != '') {
      modelViewer.animationName = animation_name; 
      modelViewer.play();  
      if(modelViewer.currentTime == 1) { 
        modelViewer.pause(); 
        modelViewer.currentTime = 0;
      }
    }else{
      modelViewer.pause();  
      modelViewer.currentTime = 1;
    }

  }
}


</script>	

	
<script>
  document.querySelector("#model-viewer").addEventListener('ar-status', (event) => {
    if(event.detail.status === 'failed'){
      const error = document.querySelector("#error");
      error.classList.remove('hide');
      error.addEventListener('transitionend',(event) => {
        error.classList.add('hide');
      });
    }
  });
</script>
</div>

	<div id="cardImg">
    <img src="images/ARbottom.gif" width="100%" alt=""/>
	</div>



	<!-- 游누 Include both scripts below to support all browsers! -->

  <!-- Loads <model-viewer> for modern browsers: -->
<script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
<script nomodule src="https://unpkg.com/@google/model-viewer/dist/model-viewer-legacy.js"></script>
</body>
</html>